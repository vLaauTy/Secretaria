<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Profesor</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">

</head>

<body>
    <div class="form-container">
        <h2>Formulario de Profesor</h2>

        <!-- Mensaje de error por DNI duplicado -->
        <div th:if="${errorMessage}" class="alert alert-danger">
            <p th:text="${errorMessage}"></p>
        </div>

        <form th:action="@{/profesor/guardar}" th:object="${profesor}" method="post">
            <!-- ID oculto para edición -->
            <input type="hidden" th:field="*{id}" />

            <div class="form-grid">
                <!-- Datos Personales -->
                <div class="form-group">
                    <label for="nombre">Nombre <span class="required">*</span></label>
                    <input type="text" id="nombre" th:field="*{nombre}" required placeholder="Ingrese el nombre">
                </div>

                <div class="form-group">
                    <label for="apellido">Apellido <span class="required">*</span></label>
                    <input type="text" id="apellido" th:field="*{apellido}" required placeholder="Ingrese el apellido">
                </div>

                <div class="form-group">
                    <label for="dni">DNI <span class="required">*</span></label>
                    <input type="text" id="dni" th:field="*{dni}" required placeholder="Ingrese el DNI"
                        pattern="[0-9]{8}" title="Debe contener 8 dígitos">
                </div>

                <div class="form-group">
                    <label for="fechaNacimiento">Fecha de Nacimiento <span class="required">*</span></label>
                    <input type="date" id="fechaNacimiento" th:field="*{fechaNacimiento}" required>
                </div>

                <div class="form-group">
                    <label for="lugarNacimiento">Lugar de Nacimiento <span class="required">*</span></label>
                    <input type="text" id="lugarNacimiento" th:field="*{lugarNacimiento}" required
                        placeholder="Ingrese el lugar de nacimiento">
                </div>

                <div class="form-group">
                    <label for="pais">País <span class="required">*</span></label>
                    <input type="text" id="pais" th:field="*{pais}" required placeholder="Ingrese el país">
                </div>

                <div class="form-group">
                    <label for="sexo">Sexo <span class="required">*</span></label>
                    <select id="sexo" th:field="*{sexo}" required>
                        <option value="">Seleccione una opción</option>
                        <option value="Hombre">Hombre</option>
                        <option value="Mujer">Mujer</option>
                    </select>
                </div>

                <!-- Datos de Contacto -->
                <div class="form-group">
                    <label for="telefono">Teléfono <span class="required">*</span></label>
                    <input type="tel" id="telefono" th:field="*{telefono}" required placeholder="Ingrese el teléfono">
                </div>

                <div class="form-group">
                    <label for="email">Email <span class="required">*</span></label>
                    <input type="email" id="email" th:field="*{email}" required placeholder="Ingrese el email">
                </div>

                <!-- Dirección -->
                <div class="form-group full-width">
                    <label for="domicilio">Domicilio <span class="required">*</span></label>
                    <input type="text" id="domicilio" th:field="*{domicilio}" required
                        placeholder="Ingrese la dirección">
                </div>

                <div class="form-group">
                    <label for="nro">Número</label>
                    <input type="text" id="nro" th:field="*{nro}" placeholder="Número de casa/departamento">
                </div>

                <div class="form-group">
                    <label for="piso">Piso</label>
                    <input type="text" id="piso" th:field="*{piso}" placeholder="Piso (si aplica)">
                </div>

                <div class="form-group">
                    <label for="codigoPostal">Código Postal <span class="required">*</span></label>
                    <input type="text" id="codigoPostal" th:field="*{codigoPostal}" required
                        placeholder="Código postal">
                </div>

                <div class="form-group">
                    <label for="localidad">Localidad <span class="required">*</span></label>
                    <input type="text" id="localidad" th:field="*{localidad}" required
                        placeholder="Ingrese la localidad">
                </div>

                <!-- Datos Administrativos -->
                <div class="form-group">
                    <label for="partida">Partida <span class="required">*</span></label>
                    <input type="text" id="partida" th:field="*{partida}" required placeholder="Número de partida">
                </div>

                <div class="form-group">
                    <label for="foja">Foja <span class="required">*</span></label>
                    <input type="number" id="foja" th:field="*{foja}" required placeholder="Número de foja" min="1">
                </div>

                <div class="form-group">
                    <label for="certificadoAF">CertificadoAF <span class="required">*</span></label>
                    <select id="certificadoAF" th:field="*{certificadoAF}" required>
                        <option value="">Seleccione una opción</option>
                        <option value="true">Sí</option>
                        <option value="false">No</option>
                    </select>
                </div>
            </div>

            <div class="btn-container">
                <button type="submit" class="btn btn-primary">Guardar Profesor</button>
                <button type="button" class="btn btn-secondary" onclick="window.history.back()">Cancelar</button>
            </div>
        </form>
    </div>

    <script>
        // Validación adicional del lado del cliente
        document.querySelector('form').addEventListener('submit', function (e) {
            const dni = document.getElementById('dni').value;
            const email = document.getElementById('email').value;

            // Validar DNI
            if (!/^\d{8}$/.test(dni)) {
                alert('El DNI debe contener exactamente 8 dígitos');
                e.preventDefault();
                return;
            }

            // Validar email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('Por favor ingrese un email válido');
                e.preventDefault();
                return;
            }
        });
    </script>
</body>

</html>